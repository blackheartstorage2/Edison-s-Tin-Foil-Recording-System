<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Tin Foil Phonograph Virtual Build</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      margin: 20px;
    }
    h1 {
      text-align: center;
    }
    .instructions {
      margin: 20px auto;
      text-align: center;
    }
    .image-grid, .build-area {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
      min-height: 150px;
      padding: 10px;
      border: 2px dashed #ccc;
      background: #fff;
    }
    .image-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100px;
    }
    .image-item img {
      width: 100px;
      height: auto;
      cursor: grab;
    }
    .image-item span {
      margin-top: 4px;
      font-size: 14px;
      font-weight: bold;
    }
    .audio-controls {
      text-align: center;
      margin-top: 40px;
    }
    button {
      padding: 10px 20px;
      margin: 10px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <h1>Build Edison's Tin Foil Recorder</h1>

  <div class="instructions">
    <p>Drag the parts from the grid below into the build area to assemble the device in the correct order (see your instructions). When complete, use the audio recorder below to simulate playback.</p>
  </div>

  <h2 style="text-align:center;">Parts</h2>
  <div class="image-grid" id="imageGrid">
    <script>
      const imageGrid = document.getElementById('imageGrid');
      const imageList = [
        { file: '0000A.jpg', label: 'A' },
        { file: '0000B.jpg', label: 'B' },
        { file: '0000C.jpg', label: 'C' },
        { file: '0000D.jpg', label: 'D' },
        { file: '00001.jpg', label: '1' },
        { file: '00002.jpg', label: '2' },
        { file: '00003.jpg', label: '3' },
        { file: '00004.jpg', label: '4' },
        { file: '00005.jpg', label: '5' },
        { file: '00006.jpg', label: '6' },
        { file: '00007.jpg', label: '7' },
        { file: '00008.jpg', label: '8' },
        { file: '00009.jpg', label: '9' },
        { file: '00010.jpg', label: '10' },
        { file: '00011.jpg', label: '11' },
        { file: '00012.jpg', label: '12' },
        { file: '00013.jpg', label: '13' },
        { file: '00014.jpg', label: '14' },
        { file: '00015.jpg', label: '15' },
        { file: '00016.jpg', label: '16' },
        { file: '00017.jpg', label: '17' },
        { file: '00018.jpg', label: '18' },
        { file: '00019.jpg', label: '19' },
        { file: '00020.jpg', label: '20' },
        { file: '00021.jpg', label: '21' },
        { file: '00022.jpg', label: '22' },
        { file: '00023.jpg', label: '23' },
        { file: '0000E.jpg', label: 'E' },
        { file: '0000F.jpg', label: 'F' }
      ];

      imageList.forEach(part => {
        const item = document.createElement('div');
        item.className = 'image-item';

        const img = document.createElement('img');
        img.src = part.file;
        img.alt = 'Part ' + part.label;
        img.draggable = true;
        img.addEventListener('dragstart', dragStart);

        const label = document.createElement('span');
        label.textContent = part.label;

        item.appendChild(img);
        item.appendChild(label);
        imageGrid.appendChild(item);
      });
    </script>
  </div>

  <h2 style="text-align:center;">Build Area</h2>
  <div class="build-area" id="buildArea" ondrop="drop(event)" ondragover="allowDrop(event)"></div>

  <div class="audio-controls">
    <h2>Audio Recorder</h2>
    <button onclick="startRecording()">Start Recording</button>
    <button onclick="stopRecording()">Stop Recording</button>
    <button onclick="playRecording()">Play Recording</button>
    <p><small>(Browser must support MediaRecorder â€” use Chrome or Firefox)</small></p>
    <audio id="audioPlayback" controls></audio>
  </div>

  <script>
    function allowDrop(ev) {
      ev.preventDefault();
    }

    function dragStart(ev) {
      ev.dataTransfer.setData("text/plain", ev.target.src);
    }

    function drop(ev) {
      ev.preventDefault();
      const src = ev.dataTransfer.getData("text/plain");
      const img = document.createElement("img");
      img.src = src;
      img.style.width = "100px";
      ev.target.appendChild(img);
    }

    // Audio recording logic
    let mediaRecorder;
    let audioChunks = [];

    async function startRecording() {
      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      mediaRecorder = new MediaRecorder(stream);
      audioChunks = [];

      mediaRecorder.ondataavailable = event => {
        audioChunks.push(event.data);
      };

      mediaRecorder.onstop = () => {
        const blob = new Blob(audioChunks, { type: 'audio/webm' });
        const url = URL.createObjectURL(blob);
        document.getElementById('audioPlayback').src = url;
      };

      mediaRecorder.start();
      console.log("Recording started");
    }

    function stopRecording() {
      if (mediaRecorder && mediaRecorder.state !== "inactive") {
        mediaRecorder.stop();
        console.log("Recording stopped");
      }
    }

    function playRecording() {
      const audio = document.getElementById('audioPlayback');
      audio.play();
    }
  </script>

</body>
</html>

